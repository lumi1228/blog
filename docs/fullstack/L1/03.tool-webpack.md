---
lang: zh-CN
title: 工程化之打包工具webpack
description: 项目需求分析：从业务需求到技术选型的全流程实践
---



> 本案例参考当前项目内demo: @/webpack-practice-demo    
> 开发环境：node v20.18.3 、 npm v10.8.2

### 安装与使用

* 初始化项目，创建package.json文件

```
$ cd webpack-practice-demo 
$ npm init -y
```
* 安装webpack

```
# 方式一： 项目安装webpack ------
$ npm install webpack webpack-cli -D
$ ./node_modules/.bin/webpack --version  # 项目查看版本

# 方式二： 全局安装webpack
$ npm install webpack webpack-cli -g
$ webpack --version  # 查看版本
```


* 在package.json配置scripts，使用webpack打包

```json title="@/package.json"
"scripts": {
  "build": "webpack"
}
```

* 执行打包

```
$ npm run build
```

### 入口与输出

* 在根目录下创建index.js作为入口文件
* 在根目录下创建webpack.config.js
* 配置入口与输出
  * 若未配置出口，默认输出到 `dist/main.js`中
  * 若配置出口，则输出到指定路径 `dist/bundle.js`中

```js title="@/webpack.config.js"
// 引入path模块
const path = require('path')

// 方式一：resolve获得当前路径
// console.log(path.resolve())
// 方式二：join拼接路径
// console.log(path.join(__dirname, './dist'))

const config = {
    entry: './src/index.js',
    output: {
        filename: 'bundle.js',
        path: path.join(__dirname, './dist')
    }
}

module.exports = config
```

### loader、plugins

##### loader

>  webpack 只能理解 JavaScript 和 JSON 文件，这是 webpack 开箱可用的自带能力。  
> loader 让 webpack 能够去处理其他类型的文件   

loader 有两个属性
* test 属性，识别出哪些文件会被转换。
* use 属性，定义出在进行转换时，应该使用哪个 loader。

loader 特性
* loader 支持链式传递。一组链式的 loader 将按照相反的顺序执行。
* loader 可以是同步的，也可以是异步的。
* loader 运行在 Node.js 中，并且能够执行任何 Node.js 能做到的操作。



loader 使用：

* 安装示例中需要的loader

```
$ npm install css-loader style-loader sass-loader -D
$ npm install url-loader file-loader -D
```


```js title="@/webpack.config.js -- 配置scss、图片loader示例如下"
const config = {
    ...
    module: {
    	rules: [
        {
          test: /(.scss|.sass)$/,
          use: ['style-loader', 'css-loader', 'sass-loader']
        },
        {
          test: /.(jpe?g|png|gif|svg)$/i,
          use: [
            {
              loader: 'url-loader',// 默认使用file-loader
              options: { 
                limit: 10000, // 10KB，小于此大小的图片会转为 base64
                name: '[name].[ext]', 
                outputPath: 'imgs/' // 超过 limit 的文件会输出到此目录
              }
            }
          ]
        }
    	]
    }
}
```

#####  plugins

> 插件是 webpack 的 支柱 功能。webpack 自身也是构建于，你在 webpack 配置中用到的相同的插件系统之上！
> 插件目的在于解决 loader 无法实现的其他事。

plugins 使用：

* 安装示例中需要的loader

```
$ npm install html-webpack-plugin -D
```

```js title="@/webpack.config.js -- 配置HtmlWebpackPlugin示例如下"
const HtmlWebpackPlugin = require('html-webpack-plugin')

const config = {
    ...
    module: {
        ...
    },
   	plugins: [
      new HtmlWebpackPlugin({
        filename: 'index.html', // 执行打包后，会在dist目录下生成index.html文件
        template: 'template.html' // 指定模板文件 在根目录下创建template.html作为模板文件
      })
   	]
}
```


###  HMR (hot module replacement)


#### 热编译
> webpack 提供了一个watch的命令，可以监听文件变化自动编译打包

* 使用watch命令：在package.json中添加脚本

```js title="@/paackage.json"
"scripts": {
  "watch": "webpack --watch" 
}
```
* 运行 `npm run watch` 命令，修改文件后都会自动编译打包, 但不会自动刷新浏览器


#### 热更新

* 安装webpack-dev-server
```
$ npm install webpack-dev-server -D
```

* paackage.json中添加脚本
```
"scripts": {
  "hot": "webpack-dev-server"
}
```
* 配置webpack.config.js,启动热更新

```js title="@/webpack.config.js"
const config = {
    ...
  	devServer: {
        hot: true
    }
}
```
* 运行 `npm run hot` 启动服务，打开`localhost:8080` 修改文件后会自动编译打包并刷新浏览器




### 模式

### babel配置

### clear-webpack-plugin

### copy-webpack-plugin

### optimize-css-assets-webpack-plugin

### terser-webpack-plugin

